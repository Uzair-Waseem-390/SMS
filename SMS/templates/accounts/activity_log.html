
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }} - School Management System</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome 6 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        * {
            font-family: 'Inter', sans-serif;
        }
        
        body {
            background: #f3f4f6;
            min-height: 100vh;
            padding: 2rem 0;
        }
        
        .log-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .log-card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
            border: 1px solid #e9ecef;
            overflow: hidden;
        }
        
        .log-header {
            background: linear-gradient(120deg, #1a1f36 0%, #2a2f4c 100%);
            color: white;
            padding: 2rem;
        }
        
        .log-header h2 {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .log-header p {
            color: #a0a3bd;
            margin: 0;
            font-size: 0.875rem;
        }
        
        .summary-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1px;
            background: #e9ecef;
        }
        
        .stat-item {
            background: white;
            padding: 1.5rem;
            text-align: center;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: #1a1f36;
            margin-bottom: 0.25rem;
        }
        
        .stat-label {
            font-size: 0.75rem;
            color: #6c757d;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .filters-section {
            padding: 1.5rem;
            background: #f8fafc;
            border-bottom: 1px solid #e9ecef;
        }
        
        .filters-form {
            display: flex;
            gap: 1rem;
            align-items: flex-end;
            flex-wrap: wrap;
        }
        
        .filter-group {
            flex: 1;
            min-width: 150px;
        }
        
        .filter-label {
            font-size: 0.75rem;
            font-weight: 500;
            color: #6c757d;
            margin-bottom: 0.25rem;
            display: block;
        }
        
        .filter-control {
            width: 100%;
            padding: 0.5rem;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            font-size: 0.875rem;
        }
        
        .filter-control:focus {
            border-color: #4f46e5;
            outline: none;
        }
        
        .btn-filter {
            padding: 0.5rem 1.5rem;
            background: #4f46e5;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
        }
        
        .btn-filter:hover {
            background: #4338ca;
        }
        
        .btn-clear {
            padding: 0.5rem 1.5rem;
            background: white;
            color: #6c757d;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            font-size: 0.875rem;
            font-weight: 500;
            text-decoration: none;
            display: inline-block;
        }
        
        .btn-clear:hover {
            background: #f8f9fa;
        }
        
        .activities-list {
            padding: 1.5rem;
        }
        
        .activity-item {
            display: flex;
            align-items: flex-start;
            padding: 1rem;
            border-bottom: 1px solid #e9ecef;
            transition: background 0.2s;
        }
        
        .activity-item:hover {
            background: #f8fafc;
        }
        
        .activity-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 1rem;
        }
        
        .icon-login { background: #e3f9ee; color: #0b5e42; }
        .icon-logout { background: #fee9e7; color: #b31b1b; }
        .icon-profile { background: #e7f0ff; color: #1a4c8c; }
        .icon-password { background: #fff4e5; color: #b45b0a; }
        .icon-payment { background: #e3f9ee; color: #0b5e42; }
        .icon-default { background: #f8f9fa; color: #6c757d; }
        
        .activity-content {
            flex: 1;
        }
        
        .activity-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 0.25rem;
        }
        
        .activity-type {
            font-size: 0.875rem;
            font-weight: 600;
            color: #1a1f36;
        }
        
        .activity-time {
            font-size: 0.75rem;
            color: #6c757d;
        }
        
        .activity-description {
            font-size: 0.875rem;
            color: #495057;
            margin-bottom: 0.25rem;
        }
        
        .activity-meta {
            font-size: 0.75rem;
            color: #6c757d;
        }
        
        .activity-meta i {
            margin-right: 0.25rem;
        }
        
        .pagination {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            padding: 1.5rem;
            border-top: 1px solid #e9ecef;
        }
        
        .page-link {
            padding: 0.5rem 1rem;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            color: #4f46e5;
            text-decoration: none;
            font-size: 0.875rem;
        }
        
        .page-link:hover {
            background: #f8f9fa;
        }
        
        .page-link.active {
            background: #4f46e5;
            color: white;
            border-color: #4f46e5;
        }
        
        .empty-state {
            text-align: center;
            padding: 3rem;
            color: #6c757d;
        }
        
        .empty-state i {
            font-size: 3rem;
            margin-bottom: 1rem;
            opacity: 0.5;
        }
        
        @media (max-width: 768px) {
            .summary-stats {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .filters-form {
                flex-direction: column;
            }
            
            .filter-group {
                width: 100%;
            }
            
            .activity-header {
                flex-direction: column;
                align-items: flex-start;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="log-container">
            <div class="log-card">
                <div class="log-header">
                    <h2><i class="fas fa-history me-2"></i>{{ title }}</h2>
                    <p>Track all your account activities</p>
                </div>
                
                <!-- Summary Stats -->
                <div class="summary-stats">
                    <div class="stat-item">
                        <div class="stat-value">{{ total_activities }}</div>
                        <div class="stat-label">Total Activities</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">{{ login_activity }}</div>
                        <div class="stat-label">Logins (7 days)</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">{{ activity_summary.0.count|default:0 }}</div>
                        <div class="stat-label">Most Frequent</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value">{{ page_obj.paginator.num_pages }}</div>
                        <div class="stat-label">Total Pages</div>
                    </div>
                </div>
                
                <!-- Filters -->
                <div class="filters-section">
                    <form method="GET" class="filters-form">
                        <div class="filter-group">
                            <label class="filter-label">Activity Type</label>
                            <select name="type" class="filter-control">
                                <option value="">All Activities</option>
                                {% for type_value, type_label in activity_types %}
                                    <option value="{{ type_value }}" {% if current_filters.type == type_value %}selected{% endif %}>
                                        {{ type_label }}
                                    </option>
                                {% endfor %}
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <label class="filter-label">Date Range</label>
                            <select name="date_range" class="filter-control">
                                <option value="">All Time</option>
                                <option value="today" {% if current_filters.date_range == 'today' %}selected{% endif %}>Today</option>
                                <option value="yesterday" {% if current_filters.date_range == 'yesterday' %}selected{% endif %}>Yesterday</option>
                                <option value="week" {% if current_filters.date_range == 'week' %}selected{% endif %}>Last 7 Days</option>
                                <option value="month" {% if current_filters.date_range == 'month' %}selected{% endif %}>Last 30 Days</option>
                            </select>
                        </div>
                        
                        <div class="filter-group">
                            <label class="filter-label">Search</label>
                            <input type="text" name="search" class="filter-control" placeholder="Search activities..." value="{{ current_filters.search }}">
                        </div>
                        
                        <button type="submit" class="btn-filter">
                            <i class="fas fa-filter me-2"></i>Apply Filters
                        </button>
                        
                        <a href="{% url 'accounts:activity_log' %}" class="btn-clear">
                            <i class="fas fa-times me-2"></i>Clear
                        </a>
                    </form>
                </div>
                
                <!-- Activities List -->
                <div class="activities-list">
                    {% if activities %}
                        {% for activity in activities %}
                            <div class="activity-item">
                                <div class="activity-icon 
                                    {% if activity.activity_type == 'login' %}icon-login
                                    {% elif activity.activity_type == 'logout' %}icon-logout
                                    {% elif activity.activity_type == 'profile_update' %}icon-profile
                                    {% elif activity.activity_type == 'password_change' %}icon-password
                                    {% elif activity.activity_type == 'payment_upload' %}icon-payment
                                    {% else %}icon-default{% endif %}">
                                    <i class="fas 
                                        {% if activity.activity_type == 'login' %}fa-sign-in-alt
                                        {% elif activity.activity_type == 'logout' %}fa-sign-out-alt
                                        {% elif activity.activity_type == 'profile_update' %}fa-user-edit
                                        {% elif activity.activity_type == 'password_change' %}fa-key
                                        {% elif activity.activity_type == 'payment_upload' %}fa-upload
                                        {% elif activity.activity_type == 'payment_verified' %}fa-check-circle
                                        {% elif activity.activity_type == 'terms_accepted' %}fa-file-signature
                                        {% else %}fa-circle{% endif %}">
                                    </i>
                                </div>
                                
                                <div class="activity-content">
                                    <div class="activity-header">
                                        <span class="activity-type">{{ activity.get_activity_type_display }}</span>
                                        <span class="activity-time">
                                            <i class="far fa-clock me-1"></i>
                                            {{ activity.timestamp|timesince }} ago
                                        </span>
                                    </div>
                                    
                                    <div class="activity-description">
                                        {{ activity.description }}
                                    </div>
                                    
                                    <div class="activity-meta">
                                        <i class="fas fa-map-marker-alt"></i>
                                        IP: {{ activity.ip_address|default:"N/A" }}
                                        
                                        {% if activity.data %}
                                            <span class="ms-3">
                                                <i class="fas fa-database"></i>
                                                {% if activity.data.updated_fields %}
                                                    Updated: {{ activity.data.updated_fields|join:", " }}
                                                {% endif %}
                                            </span>
                                        {% endif %}
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                        
                        <!-- Pagination -->
                        {% if page_obj.paginator.num_pages > 1 %}
                            <div class="pagination">
                                {% if page_obj.has_previous %}
                                    <a href="?page=1{% if current_filters.type %}&type={{ current_filters.type }}{% endif %}{% if current_filters.date_range %}&date_range={{ current_filters.date_range }}{% endif %}{% if current_filters.search %}&search={{ current_filters.search }}{% endif %}" class="page-link">
                                        <i class="fas fa-angle-double-left"></i>
                                    </a>
                                    <a href="?page={{ page_obj.previous_page_number }}{% if current_filters.type %}&type={{ current_filters.type }}{% endif %}{% if current_filters.date_range %}&date_range={{ current_filters.date_range }}{% endif %}{% if current_filters.search %}&search={{ current_filters.search }}{% endif %}" class="page-link">
                                        <i class="fas fa-angle-left"></i>
                                    </a>
                                {% endif %}
                                
                                <span class="page-link active">
                                    Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}
                                </span>
                                
                                {% if page_obj.has_next %}
                                    <a href="?page={{ page_obj.next_page_number }}{% if current_filters.type %}&type={{ current_filters.type }}{% endif %}{% if current_filters.date_range %}&date_range={{ current_filters.date_range }}{% endif %}{% if current_filters.search %}&search={{ current_filters.search }}{% endif %}" class="page-link">
                                        <i class="fas fa-angle-right"></i>
                                    </a>
                                    <a href="?page={{ page_obj.paginator.num_pages }}{% if current_filters.type %}&type={{ current_filters.type }}{% endif %}{% if current_filters.date_range %}&date_range={{ current_filters.date_range }}{% endif %}{% if current_filters.search %}&search={{ current_filters.search }}{% endif %}" class="page-link">
                                        <i class="fas fa-angle-double-right"></i>
                                    </a>
                                {% endif %}
                            </div>
                        {% endif %}
                    {% else %}
                        <div class="empty-state">
                            <i class="fas fa-history"></i>
                            <h5>No activities found</h5>
                            <p class="text-muted">There are no activities matching your criteria.</p>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>